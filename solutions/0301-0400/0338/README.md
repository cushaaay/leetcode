**(№ 338) Counting Bits [easy]**

Дано число n. Нужно вернуть массив ans длиной n + 1, в котором на каждом месте ans[i] будет записано количество единиц содержащихся в двоичной записи числа i.

**Решение на JavaScript**

```javascript
var countBits = function(n) {
  let ans = Array(n + 1).fill(0);
  let offset = 1;
  
  for (let i = 1; i < n + 1; i++) {
    if (offset * 2 === i) offset = i;
    ans[i] = 1 + ans[i - offset];
  }
  
  return ans;
};
```

**Объяснение решения**

Каждое новое число зависит от какого-то прошлого числа. Можно заметить, что все числа кратные двум в двоичном виде увеличиваются на один разряд. Но после этого разряда, если его мысленно убрать, идут такие же числа, какие шли до добавления этого разряда. Поэтому наша задача при вычислении каждого числа знать, с какого числа началось повышение разряда и вычитать это число, тогда мы получим индекс ячейки, в которо уже лежит количество единиц посчитанное для этого числа, плюс искуственно добавляем 1, ведь повышение разряда это всегда число с одной 1 и сколькими-то нулями.

0000 0
0001 1 это 1 + ans[1 - 1]

0010 2 это 1 + ans[2 - 2]
0011 3 это 1 + ans[3 - 2]

0100 4 это 1 + ans[4 - 4]
0101 5 это 1 + ans[5 - 4]
0110 6 это 1 + ans[6 - 4]
0111 7 это 1 + ans[7 - 4]

1000 8 это 1 + ans[8 - 8]
1001 9 это 1 + ans[9 - 8]
1010 10 это 1 + ans[10 - 8]
1011 11 это 1 + ans[11 - 8]
1100 12 это 1 + ans[12 - 8]
1101 13 это 1 + ans[13 - 8]
1110 14 это 1 + ans[14 - 8]
1111 15 это 1 + ans[15 - 8]

10000 16 это 1 + ans[16 - 16]

**Ссылка на задачу:** https://leetcode.com/problems/counting-bits/